# GlyphLoom Â· å­—ç»‡æœº Â· é¡¹ç›®æ€»è§ˆï¼ˆå¼€å‘è€…è§†è§’ï¼‰

> é¢å‘ç©å®¶ / æ±‰åŒ–ç»„ / å¼€å‘è€…çš„ **æ¸¸æˆæ–‡æœ¬æœ¬åœ°åŒ–å·¥å…·ç®±**  
> ä¸€æ¡ç»Ÿä¸€ã€å¯ç¼–ç¨‹ã€å¯æ‰©å±•çš„é™æ€æœ¬åœ°åŒ–æµæ°´çº¿ï¼Œç”¨ LLM é©±åŠ¨é«˜è´¨é‡äº§å‡ºã€‚

---

## 1. äº§å“å®šä½ä¸ç›®æ ‡

### 1.1 Why

- ç°æœ‰å·¥å…·è¦ä¹ˆç»‘æ­»åœ¨å•ä¸€æ¸¸æˆ/å¼•æ“ï¼Œè¦ä¹ˆåªæ˜¯å®æ—¶æœºç¿»å åŠ ï¼›æˆ‘ä»¬è¦åšçš„æ˜¯ **ç¦»çº¿ã€æ‰¹é‡ã€å¯é‡å¤çš„æœ¬åœ°åŒ–ç®¡çº¿**ã€‚
- ç›®æ ‡å—ä¼—ï¼š
  - **å¼€å‘è€…**ï¼šæ‹¿åˆ° `glyphloom_core` ä½œä¸º SDK / Pipelineï¼ŒåµŒå…¥è‡ªå·±çš„è‡ªåŠ¨åŒ–å·¥å…·ã€‚
  - **ç©å®¶ / æ±‰åŒ–ç»„**ï¼šä½¿ç”¨ `glyphloom_gui` æ‹–æ‹½æ¸¸æˆã€é…ç½®æµç¨‹ã€ä¸€é”®ç”Ÿæˆæœ¬åœ°åŒ–åŒ…ã€‚

### 1.2 What

- ä¸€æ¡â€œæå– â†’ ç¿»è¯‘ â†’ QA â†’ å¯¼å‡ºâ€çš„æ ‡å‡†æµæ°´çº¿ï¼Œå¯æ’æ‹”æ‰©å±•ã€‚
- GUI = è°ƒåº¦å±‚ï¼›Core = ä¸šåŠ¡é€»è¾‘å±‚ã€‚GUI ç»ä¸å†™ä¸šåŠ¡åˆ¤æ–­ï¼ŒCore ç»ä¸ä¾èµ– Qtã€‚

### 1.3 æœ€ä½å¯æ¥å—æ ‡å‡†

1. **æ ¸å¿ƒé€»è¾‘åªèƒ½å†™åœ¨ core**ï¼šä»»ä½•æŠ½å–ã€ç¿»è¯‘ã€QAã€LLM è°ƒç”¨éƒ½åœ¨ coreï¼ŒGUI ä»…è´Ÿè´£ orchestrateã€‚
2. **é—­ç¯ä¼˜å…ˆ**ï¼šExcel â†’ Pipeline â†’ Excel+QA çš„å®Œæ•´é“¾è·¯å¿…é¡»åœ¨æ—©æœŸæ‰“é€šã€‚
3. **LLM åç«¯å¯æ’æ‹”**ï¼šäº‘ç«¯ã€æœ¬åœ°ã€è‡ªå»ºæœåŠ¡å…¨éƒ¨é€šè¿‡ç»Ÿä¸€ TranslatorConfig æ¥å£ã€‚
4. **æ¶æ„è¦æœ‰ä½™é‡**ï¼šå¼•æ“é€‚é…ã€æ’ä»¶ã€TM/æœ¯è¯­è¡¨ã€GUI æ–‡æœ¬ç¼–è¾‘éƒ½è¦é¢„ç•™æŒ‚ç‚¹ã€‚

---

## 2. æ ¸å¿ƒè®¾è®¡åŸåˆ™

1. **Core = Library**  
   - `glyphloom_core` å¿…é¡»å¯ `pip install`ï¼Œå¯åœ¨ headless ç¯å¢ƒä½¿ç”¨ï¼Œä¸ä¾èµ– GUIã€‚
2. **Pipeline é©±åŠ¨**  
   - æ‰€æœ‰åŠŸèƒ½å›´ç»•é˜¶æ®µå¼ pipelineï¼Œé˜¶æ®µå¯é…ç½®/æ›¿æ¢ï¼ŒCLI ä¸ GUI å…±ç”¨åŒä¸€å¥— APIã€‚
3. **é…ç½®ä¼˜å…ˆ**  
   - `config.yaml` + GUI è¡¨å•æ§åˆ¶è¡Œä¸ºï¼›å¼€å‘è€…å¯ç›´æ¥å†™ YAMLï¼›é…ç½®æ¨¡å‹ï¼ˆTranslatorConfig / AdapterConfig / QaConfig ç­‰ï¼‰å¿…é¡»ç›´è§‚ã€‚
4. **å¹³å°æ— å…³**  
   - è·¯å¾„ç”¨ `pathlib`ï¼›
   - å…¨å±€ç»Ÿä¸€ `UTF-8`ï¼›
   - ä¸ç”¨ Windows ç‰¹å®š APIï¼›
   - è¯¦ç»†ç­–ç•¥è§ [docs/design_notes/platforms.md](design_notes/platforms.md)ã€‚
   - å…¨è·¯å¾„ `pathlib`ï¼Œç»Ÿä¸€ UTF-8ï¼Œä¸å†™ Windows ä¸“å± APIï¼Œå°†è·¨å¹³å°å·®å¼‚æ”¶æ•›åœ¨ GUI æ‰“åŒ…å±‚ã€‚

---

## 3. æŠ€æœ¯æ ˆé€Ÿè§ˆ

| æ¨¡å—              | æŠ€æœ¯/åº“                                           |
| ----------------- | ------------------------------------------------ |
| æ ¸å¿ƒè¯­è¨€          | Python 3.12+                                     |
| Core              | `pydantic`, `pandas`, `openpyxl`, `httpx`, `pyyaml`, `rich` |
| GUI               | `PySide6`ï¼Œè‡ªç ” JSON i18n                        |
| å·¥å…· & è´¨é‡       | `pytest`, `ruff`, `black`ï¼ˆè§†éœ€æ±‚ï¼‰               |

---

## 4. ç›®å½•ç»“æ„ï¼ˆè§„åˆ’ç¨¿ï¼‰

```text
glyphloom/
  glyphloom_core/
    __init__.py
    api.py                  # å¯¹ GUI / CLI æš´éœ²çš„é«˜é˜¶æ¥å£
    core/
      models.py             # Line / Config æ•°æ®ç»“æ„
      pipeline.py           # ä¸»æµæ°´çº¿ orchestrator
      config_loader.py      # è¯»å†™ YAMLã€åˆå¹¶ GUI è¡¨å•
      placeholders.py       # å ä½ç¬¦è¯†åˆ«å·¥å…·
    adapters/
      base.py
      table_adapter.py      # Excel / CSV
      json_adapter.py       # JSON / JSONLï¼ˆåç»­ï¼‰
      po_adapter.py         # gettext POï¼ˆåç»­ï¼‰
    engines/
      detector.py           # å¼•æ“è¯†åˆ«
      renpy_miner.py
      unity_miner.py
      unreal_miner.py
    translators/
      base.py
      openai_http.py        # OpenAI / DeepSeek
      openai_compatible.py  # Ollama / ä»»æ„ OAI å…¼å®¹æœåŠ¡
      local_python.py       # llama-cpp / transformersï¼ˆåæœŸï¼‰
    qa/
      base.py
      placeholder_check.py
      length_check.py
  glyphloom_gui/
    __init__.py
    main.py                 # GUI å…¥å£
    app.py                  # QApplication åŒ…è£…
    viewmodels/             # GUI çŠ¶æ€ä¸ Core äº¤äº’ï¼ˆä¸šåŠ¡è°ƒç”¨é›†ä¸­åœ¨æ­¤ï¼‰
    widgets/                # è‡ªå®šä¹‰æ§ä»¶
    assets/                 # å›¾æ ‡ã€ä¸»é¢˜ã€å­—ä½“ç­‰
    i18n/                   # å¤šè¯­è¨€ JSON æ–‡æ¡ˆ
  glyphloom_cli/            # ï¼ˆé¢„ç•™ï¼‰å‘½ä»¤è¡Œå…¥å£ï¼ŒåæœŸå®ç°
    __init__.py
    main.py
  docs/
    project_overview.md
    roadmap.md
    design_notes/
  templates/                # å®˜æ–¹ç¤ºä¾‹æ¨¡æ¿ï¼ˆExcel ç­‰ï¼‰
  tests/                    # å•å…ƒ & é›†æˆæµ‹è¯•ç›®å½•
```

---

## 5. ç«¯åˆ°ç«¯æµæ°´çº¿

### 5.1 Core Pipeline é˜¶æ®µ

1. **æå– Extract**  
   - ç”± `engines/*` miner å®šä½æ¸¸æˆèµ„æºæ–‡ä»¶ï¼Œå†äº¤ç»™ adapter è½¬ä¸ºç»Ÿä¸€æ•°æ®æ¨¡å‹ã€‚  
   - æ—©æœŸä¼˜å…ˆ Excel/CSVï¼ˆTableAdapterï¼‰ï¼Œåç»­ JSON/PO ç­‰ã€‚
2. **ç¿»è¯‘ Translate**  
   - `translators/*` ç»Ÿä¸€ `TranslatorConfig`ï¼ŒLLM è°ƒç”¨é€šè¿‡ HTTPï¼ˆOpenAI å…¼å®¹ï¼‰æˆ–æœ¬åœ° Python å¼•æ“ã€‚
   - æ”¯æŒæ‰¹é‡/åˆ†æ®µï¼Œä¸”å ä½ç¬¦ä¿æŠ¤ã€æœ¯è¯­è¡¨åº”ç”¨ã€é£æ ¼ prompt ç­‰ç»Ÿä¸€æ”¾åœ¨ translator å±‚å¤„ç†ã€‚
3. **QA Validate**  
   - å¤šä¸ªæ£€æŸ¥å™¨ä¸²è”ï¼šå ä½ç¬¦ã€é•¿åº¦ã€ç¦è¯ã€æ ¼å¼ä¸€è‡´æ€§ç­‰ï¼Œè§„åˆ™å¯é…ç½®ã€‚
4. **å¯¼å‡º Export**  
   - åå‘å†™å› Excel/JSON/POï¼Œé™„å¸¦ QA æŠ¥å‘Šï¼ˆè¡¨æ ¼æ–‡ä»¶ï¼Œä¼˜å…ˆ Excelï¼Œä¹Ÿå¯æ”¯æŒ CSVï¼‰ï¼›æœªæ¥åŠ â€œç”Ÿæˆæ¸¸æˆè¡¥ä¸â€èƒ½åŠ›ã€‚

### 5.2 GUI è§¦å‘æµç¨‹ï¼ˆGlyphLoom Studioï¼‰

1. **é¡¹ç›®å¯¼èˆª**ï¼šåˆ—ä¸¾å†å²é¡¹ç›®ã€åˆ›å»ºæ–°é¡¹ç›®å‘å¯¼ã€‚
2. **å¼•æ“è¯†åˆ«**ï¼šæ‹–æ‹½æ¸¸æˆç›®å½• â†’ `engines.detector` ç»™å‡ºçŒœæµ‹ â†’ é€‰æ‹©/ç¡®è®¤ â†’ è¿›å…¥æ–‡ä»¶æ‰«æã€‚
3. **æ–‡ä»¶ & Adapter ç®¡ç†**ï¼šåˆ—å‡º miner æ‰¾åˆ°çš„æ–‡ä»¶ç±»å‹ï¼Œç”¨æˆ·å‹¾é€‰ï¼Œç”¨é€‚é…å™¨ç”Ÿæˆ pipeline è¾“å…¥ã€‚
4. **é…ç½®é˜¶æ®µ**ï¼šå¡«å†™ LLMã€æœ¯è¯­è¡¨ã€æ‰¹é‡ç­–ç•¥ï¼›è¡¨å•æ˜ å°„åˆ° `config.yaml`ã€‚
5. **è¿è¡Œç›‘æ§**ï¼šå±•ç¤º pipeline è¿›åº¦ï¼ˆ`rich`/GUI è¿›åº¦æ¡ï¼‰ï¼Œæ”¯æŒæš‚åœ/æ¢å¤ã€‚
6. **QA / å¯¼å‡º**ï¼šå±•ç¤º QA ç»“æœã€å¯¼å‡ºè·¯å¾„ï¼Œå…è®¸å†æ¬¡è¿è¡ŒæŸä¸€é˜¶æ®µã€‚

---

## 6. GUI äº¤äº’è¦ç‚¹

### 6.1 ä¸»ç•Œé¢

- **å¿«é€Ÿå…¥å£**ï¼šæ–°å»ºé¡¹ç›®ã€æ‰“å¼€æœ€è¿‘é¡¹ç›®ã€æŸ¥çœ‹æ–‡æ¡£ã€‚
- **è¿›åº¦æ¦‚è§ˆ**ï¼šæ¯ä¸ªé¡¹ç›®æ˜¾ç¤ºå½“å‰é˜¶æ®µã€æœ€æ–°ä¸€æ¬¡ QA æ˜¯å¦é€šè¿‡ã€‚

### 6.2 é¡¹ç›®è§†å›¾

- **æ–‡ä»¶æ ‘**ï¼šæ¥æºæ–‡ä»¶ã€é€‚é…å™¨ç”Ÿæˆçš„ä¸­é—´æ–‡ä»¶ã€QA æŠ¥è¡¨ã€‚
- **æµæ°´çº¿é¢æ¿**ï¼šå¯å•ç‹¬è¿è¡Œ â€œæå–/ç¿»è¯‘/QA/å¯¼å‡ºâ€ï¼Œå±•ç¤ºæ—¥å¿—ã€‚
- **QA æ±‡æ€»**ï¼šè¡¨æ ¼åŒ–å±•ç¤ºå ä½ç¬¦ã€é•¿åº¦ç­‰é—®é¢˜ï¼›å¯¼å‡ºæ ¼å¼ä»¥ Excel ä¸ºä¸»ï¼Œå¹¶å¯è¿½åŠ  CSVã€‚

### 6.3 è®¾ç½®é¢æ¿

- **LLM è®¾ç½®**ï¼š`provider/base_url/api_key/model`ï¼›æµ‹è¯•è¿æ¥æŒ‰é’®ï¼›å¹¶å‘ã€è¶…æ—¶é«˜çº§å‚æ•°ã€‚
- **GUI è®¾ç½®**ï¼šä¸»é¢˜ã€è¯­è¨€ã€å¼€æœºè‡ªå¯ã€ç¼“å­˜æ¸…ç†ã€‚
- **æ’ä»¶/é«˜çº§**ï¼ˆé¢„ç•™ï¼‰ï¼šè·¯å¾„æ˜ å°„ã€è‡ªå®šä¹‰è„šæœ¬æŒ‚è½½ç‚¹ã€‚

---

## 7. LLM & æœ¬åœ°æ¨¡å‹æ”¯æŒ

### 7.1 ç»Ÿä¸€æŠ½è±¡

- é€šè¿‡ `TranslatorConfig` æè¿° providerã€base_urlã€modelã€é¢å¤–å‚æ•°ã€‚
- Core å†…éƒ¨æ°¸è¿œä½¿ç”¨ç»Ÿä¸€æ¥å£ï¼Œå…·ä½“å®ç°å¯åˆ‡æ¢ `openai_http`ã€`openai_compatible`ã€`local_python`ã€‚
- å ä½ç¬¦ä¿æŠ¤ / æœ¯è¯­è¡¨åœ¨ translator å±‚ç»Ÿä¸€å®ç°ï¼ŒGUI ä¸å…³å¿ƒç»†èŠ‚ã€‚

### 7.2 ä½¿ç”¨åœºæ™¯

| åœºæ™¯          | é…ç½®è¦ç‚¹                                                     |
| ------------- | ------------------------------------------------------------ |
| äº‘ç«¯ LLM      | åªè¦æœ‰ Keyï¼›GUI ä¸­å¡«å…¥ base_url / api_key / modelï¼Œç›´æ¥è·‘ã€‚ |
| æœ¬åœ° LLM      | ç”¨æˆ·åœ¨æœ¬æœº/å±€åŸŸç½‘éƒ¨ç½² OAI å…¼å®¹æœåŠ¡ï¼ˆOllamaã€LM Studio ç­‰ï¼‰ï¼Œé…ç½® base_urlã€modelï¼›GUI ä¸€å¾‹æŒ‰ OpenAI å…¼å®¹è°ƒç”¨ã€‚ |
| è‡ªç ” Python æ¨ç† | `local_python` translator è´Ÿè´£è°ƒç”¨ llama-cpp / transformersï¼ŒGUI ä»ç”¨åŒä¸€æ¥å£ã€‚ |

---

## 8. å¼€å‘æµç¨‹ä¸çº¦å®š

### 8.1 ç¯å¢ƒ

- Python 3.12+  
- å»ºè®®ç”¨ `uv` æˆ– `poetry`ï¼š`uv pip install -e ".[dev]"`ã€‚

### 8.2 ä»£ç é£æ ¼

- å¼ºåˆ¶ type hintsï¼Œæ¨¡å—è¾¹ç•Œæ¸…æ™°ï¼ˆcore vs guiï¼‰ã€‚
- é€»è¾‘ä¸ IO åˆ†ç¦»ï¼›core é¿å… `print`ï¼Œç»Ÿä¸€ loggerã€‚
- é…ç½®æ¨¡å‹ä¸ pipeline æ­¥éª¤ä¿æŒå¯æµ‹è¯•æ€§ã€‚

### 8.3 æµ‹è¯•ç­–ç•¥

- å•å…ƒæµ‹è¯•ä¼˜å…ˆè¦†ç›– `models/adapters/translators/qa`ã€‚
- å‡†å¤‡ä¸€ä¸ª demo é¡¹ç›®è·‘é€šé›†æˆæµ‹è¯•ï¼šExcel â†’ ç¿»è¯‘ â†’ QA â†’ å¯¼å‡ºã€‚
- GUI å±‚åšæœ€å°åŒ–è‡ªåŠ¨åŒ–æµ‹è¯•ï¼Œé‡ç‚¹å›å½’ pipeline APIã€‚

---

## 9. Roadmapï¼ˆè¶…ç²¾ç®€ï¼‰

1. **é˜¶æ®µ 0ï¼šéª¨æ¶**  
   - æ­å‡º core / gui ç›®å½•ç»“æ„ï¼ŒCLI & GUI å¯å¯åŠ¨ã€‚
2. **é˜¶æ®µ 1ï¼šæ¨¡æ¿é—­ç¯**  
   - TableAdapterã€å‡ç¿»è¯‘ã€QA é€šè·¯æ‰“é€šï¼ŒGUI å¯åˆ›å»ºé¡¹ç›®å¹¶è·‘æ¨¡æ¿ä»»åŠ¡ã€‚
3. **é˜¶æ®µ 2ï¼šå ä½ç¬¦ & QA**  
   - å ä½ç¬¦è¯†åˆ« + QA æŠ¥è¡¨ï¼ŒGUI æ”¯æŒä»…è¿è¡Œ QAã€‚
4. **é˜¶æ®µ 3ï¼šå¼•æ“æ£€å‡º & æ–‡æœ¬æŒ–æ˜**  
   - `detector + renpy_miner` ä¼˜å…ˆå®Œæˆï¼ŒGUI æœ‰æ¸¸æˆå‘å¯¼ã€‚
5. **é˜¶æ®µ 4ï¼šOpenAI å…¼å®¹ / æœ¬åœ° LLM**  
   - `openai_compatible` translatorã€GUI LLM è®¾ç½®é€‚é…æœ¬åœ°æœåŠ¡ã€‚
6. **é˜¶æ®µ 5+**  
   - æ’ä»¶ç³»ç»Ÿã€å¤šè¯­è¨€ UIã€ç¿»è¯‘è®°å¿†ã€æœ¯è¯­è¡¨ç®¡ç†ã€GUI å†…è”æ–‡æœ¬ç¼–è¾‘ç­‰ã€‚

è¯¦å°½ä»»åŠ¡æ‹†è§£è§ `docs/roadmap.md`ã€‚

---

## 10. è‡ªæˆ‘æé†’

- README å†™ç»™å…¬ä¼—ï¼›`docs/project_overview.md` å†™ç»™è‡ªå·±ä¸åä½œè€…ã€‚  
- æ‰€æœ‰å®ç°éƒ½è¦å›æº¯åˆ°æœ¬æ–‡ä»¶å®šä¹‰çš„éª¨æ¶ä¸åº•çº¿ï¼Œé¿å…å‡ºç°â€œè¶Šå†™è¶Šæ•£â€çš„å‰¯ä½œç”¨ã€‚  
- éšç€é˜¶æ®µæ¨è¿›ï¼Œé€‚åº¦æ›´æ–°æ­¤æ–‡æ¡£ï¼Œä¿æŒæ ¸å¿ƒè®¾è®¡å†³ç­–å¯è¿½æº¯ã€‚
## 11. Æ½Ì¨Ö§³Ö²ßÂÔ£¨ÕªÒª£©

- core (`glyphloom_core`)£º½öÊ¹ÓÃ¿çÆ½Ì¨ÒÀÀµ£¬±ØĞëÔÚ Windows / Linux / macOS ÉÏĞĞÎªÒ»ÖÂ¡£
- GUI (`glyphloom_gui`)£º»ùÓÚ PySide6£¬Ä¿±êÖ§³ÖÈıÆ½Ì¨ÔËĞĞ£»´ò°ü²ßÂÔ¿É°´Æ½Ì¨²îÒìÊµÏÖ¡£
- ¿ª·¢½Å±¾£¨`scripts/*.ps1`£©£º½ö×÷ÎªÄÚ²¿¹¤¾ß£¬ÔÊĞí Windows-only£¬Ö»Òª²»Ó°ÏìºËĞÄ°ü°²×°¡£

> ÍêÕûËµÃ÷¼û [docs/design_notes/platforms.md](design_notes/platforms.md)¡£
